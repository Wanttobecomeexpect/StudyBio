<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>StudyBio ‚Äî Chapter: Body Fluids and Circulation</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Poppins:wght@500;700&family=Patrick+Hand&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="globalstyle.css">
    <link rel="stylesheet" href="chaptersstyle.css">
</head>

<body class="light">

    <!-- Loader -->
    <div id="loader" aria-hidden="false">
        <div class="book-loader" role="status" aria-live="polite">
            <div class="book" aria-hidden="true">
                <div class="cover cover-left"></div>
                <div class="pages">
                    <div class="page"></div>
                    <div class="page"></div>
                    <div class="page"></div>
                </div>
                <div class="cover cover-right"></div>
            </div>
            <p class="loading-text">Loading Body Fluids and Circulation...</p>
        </div>
    </div>

    <div id="site-content" style="display:none;">

        <!-- Floating shapes -->
        <div class="floating-shape shape1" aria-hidden="true"></div>
        <div class="floating-shape shape2" aria-hidden="true"></div>
        <div class="floating-shape shape3" aria-hidden="true"></div>
        <div class="bio-dna floating-shape" aria-hidden="true">üß¨</div>
        <div class="bio-microscope floating-shape" aria-hidden="true">üî¨</div>
        <div class="bio-leaf floating-shape" aria-hidden="true">üçÉ</div>
        <div class="bio-cell floating-shape" aria-hidden="true">ü¶†</div>

        <header class="scroll">
            <div class="logo"><a href="index.html">StudyBio</a> </div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="resources.html">Resources</a>
                <a href="quizzes.html">Quizzes</a>
                <a href="about.html">About</a>
            </div>
            <button class="toggle-btn" id="theme-toggle">Dark Mode</button>
        </header>

        <!-- Mobile nav -->
        <nav class="mobile-nav" aria-hidden="true">
            <a href="index.html">Home</a>
            <a href="resources.html">Resources</a>
            <a href="quizzes.html">Quizzes</a>
            <a href="about.html">About</a>
        </nav>

        <!-- main wrap -->
        <div class="wrap" role="main">
            <aside class="sidebar" id="sidebar">
                <h3>Chapter Contents</h3>
                <ul id="toc" class="chapter-topics chapter-list-scroll">
                    <li><a href="#blood">Blood ‚Äî Composition & Functions</a></li>
                    <li><a href="#lymph">Lymph</a></li>
                    <li><a href="#heart">Heart ‚Äî Structure & Cardiac Cycle</a></li>
                    <li><a href="#blood-vessels">Blood Vessels & Circulatory Routes</a></li>
                    <li><a href="#hemostasis">Hemostasis & Blood Groups (brief)</a></li>
                    <li><a href="#summary">Summary</a></li>
                </ul>
            </aside>

            <article class="content" id="content">
                <div class="chapter-header">
                    <div class="nav"><a href="index.html" class="hover">Home</a> ‚Ä∫ <span>Body Fluids and
                            Circulation</span>
                    </div>
                    <h1>Body Fluids and Circulation</h1>
                    <div class="muted">Composition and functions of blood and lymph; heart structure and cardiac cycle;
                        circulation pathways.</div>
                </div>

                <div class="paper-divider"></div>

                <section id="blood" class="subtopic">
                    <h3>Blood ‚Äî Composition & Functions</h3>
                    <p>Blood consists of plasma (water, proteins, nutrients) and formed elements (RBCs, WBCs,
                        platelets).
                        Functions: transport, defense, regulation of temperature and pH.</p>
                </section>

                <section id="lymph" class="subtopic">
                    <h3>Lymph</h3>
                    <p>Lymph is the interstitial fluid collected via lymphatic system; contains lymphocytes and returns
                        proteins/fluids to circulatory system; important in immunity and fat transport from intestine.
                    </p>
                </section>

                <section id="heart" class="subtopic">
                    <h3>Heart ‚Äî Structure & Cardiac Cycle</h3>
                    <p>Heart chambers, valves (AV and semilunar), cardiac muscle properties. Cardiac cycle phases:
                        atrial
                        systole, ventricular systole, diastole; heart sounds and role of ECG (basic idea).</p>
                </section>

                <section id="blood-vessels" class="subtopic">
                    <h3>Blood Vessels & Circulatory Routes</h3>
                    <p>Arteries (carry blood away - thick muscular walls), veins (to heart - valves in limbs),
                        capillaries
                        (exchange sites). Circulation: pulmonary (lungs) and systemic (body), portal systems (e.g.,
                        hepatic
                        portal).</p>
                </section>

                <section id="hemostasis" class="subtopic">
                    <h3>Hemostasis & Blood Groups (Brief)</h3>
                    <p>Hemostasis: vascular spasm, platelet plug, coagulation cascade leading to fibrin clot. Blood
                        groups
                        (ABO, Rh) are important for transfusion compatibility.</p>
                </section>

                <section id="summary" class="subtopic">
                    <h3>Summary</h3>
                    <p>Circulatory system ensures distribution of gases, nutrients and immune cells. Understanding blood
                        components, heart function and vascular structure is essential for physiology and medicine.</p>
                </section>
                <!-- sticky diagram card -->
                <div>
                    <div class="sticky-diagram" role="complementary" aria-label="Diagram preview">
                        <img src="/mnt/data/c1e864a8-0266-42fe-8deb-cc7b86ffd7b8.png" alt="Labeled plant diagram"
                            id="stickyImg">
                        <div style="width:100%;display:flex;gap:8px">
                            <button class="btn primary" id="previewBtn">Preview</button>
                            <button class="btn ghost" id="notesBtn">Add Note</button>
                        </div>
                        <div class="note">Tap preview to open large view. Use 'Add Note' to leave a sticky note
                            (demo).
                        </div>
                    </div>
                </div>
                <div class="paper-divider">

                    <div style="display: flex; justify-content: space-between; margin: 24px; padding: 16px;">
                        <button class="btn ghost chapter-nav" id="prevChapter">
                            <a href="zch4.html">‚Üê Previous Chapter</a>
                        </button>
                        <button class="btn ghost chapter-nav" id="nextChapter">
                            <a href="zch6.html">Next Chapter ‚Üí</a>
                        </button>
                    </div>

                    <div>
                        <button class="btn primary" id="startQuiz">
                            <a href="quizzes.html" class="quiz-link">Start Chapter Quiz</a>
                        </button>
                    </div>
                </div>
            </article>
        </div>

        <!-- PREVIEW POPUP -->
        <div class="preview-bg" id="previewBg" role="dialog" aria-modal="true" aria-hidden="true">
            <div class="preview-card" role="document">
                <img id="previewImg" src="/mnt/data/c1e864a8-0266-42fe-8deb-cc7b86ffd7b8.png" alt="Diagram preview">
                <div class="preview-actions">
                    <button class="btn ghost" id="closePreview">Close</button>
                    <button class="btn primary" id="downloadPreview">Download</button>
                </div>
            </div>
        </div>
        <!-- Footer -->
        <footer>
            &copy; 2025 StudyBio ‚Äî Unlocking the Secrets of Life
        </footer>
        <script src="globalnext.js"></script>
        <script>
            // active clicking effect
            const links = document.querySelectorAll('#toc a');

            links.forEach(link => {
                link.addEventListener('click', () => {
                    // remove active from all
                    links.forEach(l => l.classList.remove('active'));

                    // add active to clicked one
                    link.classList.add('active');
                });
            });
            // Sidebar mobile toggle
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const drawerOverlay = document.getElementById('drawerOverlay');
            function openDrawer() {
                sidebar.style.position = 'fixed';
                sidebar.style.left = '12px';
                sidebar.style.top = '84px';
                sidebar.style.width = 'calc(100% - 24px)';
                sidebar.style.maxHeight = 'calc(100% - 120px)';
                drawerOverlay.style.display = 'block';
                drawerOverlay.setAttribute('aria-hidden', 'false');
            }
            function closeDrawer() {
                sidebar.style.position = '';
                sidebar.style.left = '';
                sidebar.style.top = '';
                sidebar.style.width = '';
                drawerOverlay.style.display = 'none';
                drawerOverlay.setAttribute('aria-hidden', 'true');
            }
            menuToggle.addEventListener('click', () => {
                const isOpen = drawerOverlay.style.display === 'block';
                if (isOpen) closeDrawer(); else openDrawer();
            });
            drawerOverlay.addEventListener('click', closeDrawer);

            // Smooth anchor scrolling + active toc highlight
            const tocLinks = document.querySelectorAll('.chapter-topics a');
            function setActive(anchor) {
                tocLinks.forEach(a => a.classList.toggle('active', a === anchor));
            }
            tocLinks.forEach(a => {
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    closeDrawer();
                    const id = a.getAttribute('href');
                    document.querySelector(id).scrollIntoView({ behavior: 'smooth', block: 'start' });
                    setActive(a);
                });
            });

            // IntersectionObserver to auto-highlight TOC while scrolling
            const sections = document.querySelectorAll('article .subtopic, article .chapter-header');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(ent => {
                    if (ent.isIntersecting && ent.target.id) {
                        const link = document.querySelector('.chapter-topics a[href="#' + ent.target.id + '"]');
                        if (link) setActive(link);
                    }
                });
            }, { threshold: 0.45 });
            sections.forEach(s => observer.observe(s));


            // Preview popup
            const previewBg = document.getElementById('previewBg');
            const previewImg = document.getElementById('previewImg');
            const previewBtn = document.getElementById('previewBtn');
            const closePreview = document.getElementById('closePreview');
            const downloadPreview = document.getElementById('downloadPreview');

            previewBtn.addEventListener('click', () => openPreview(document.getElementById('stickyImg').src));
            document.getElementById('open3d').addEventListener('click', (e) => { e.preventDefault(); openPreview(document.getElementById('stickyImg').src); });

            function openPreview(src) {
                previewImg.src = src;
                previewBg.style.display = 'flex';
                previewBg.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden'; // prevent background scroll
            }
            function closePreviewHandler() {
                previewBg.style.display = 'none';
                previewBg.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = ''; // restore
            }
            closePreview.addEventListener('click', closePreviewHandler);
            previewBg.addEventListener('click', (e) => {
                if (e.target === previewBg) closePreviewHandler();
            });
            downloadPreview.addEventListener('click', () => {
                const a = document.createElement('a');
                a.href = previewImg.src;
                a.download = previewImg.src.split('/').pop();
                document.body.appendChild(a); a.click(); a.remove();
            });

            // "Add Note" demo (simple sticky note)
            document.getElementById('notesBtn').addEventListener('click', () => {
                const note = prompt('Add a short note for this chapter:');
                if (!note) return;
                const n = document.createElement('div');
                n.style.padding = '8px'; n.style.borderRadius = '8px'; n.style.background = 'rgba(255,255,255,0.9)'; n.style.marginTop = '8px';
                n.style.fontFamily = 'Patrick Hand'; n.style.boxShadow = '0 6px 18px rgba(0,0,0,0.06)';
                n.textContent = note;
                document.querySelector('.sticky-diagram').appendChild(n);
            });

            // Accessibility: ESC to close preview or drawer
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closePreviewHandler();
                    closeDrawer();
                }
            });

            // Optional: start quiz button demo
            document.getElementById('startQuiz').addEventListener('click', () => {
                alert('Quiz feature opens (demo). Link to quizzes.html or open in a modal as needed.');
            });

        </script>
</body>

</html>